# 步骤 5：前端研究流程组件实现

## 子任务 5.1：实现问题表单组件

### 复现步骤

1. 创建`src/components/ui/deep-research/QuestionForm.tsx`文件
2. 实现问题表单逻辑：
   - 使用 React Hook Form 管理表单
   - 显示当前问题
   - 实现导航（上一题/下一题）功
   - 显示进度条
3. 连接到状态管理：
   - 读取当前问题和总问题数
   - 存储用户答案
   - 在完成所有问题后设置`isCompleted`状态

### 测试方法

在浏览器中测试问题表单组件，回答问题并导航，验证：

1. 问题显示是否正确
2. 导航是否正常工作
3. 进度条是否正确更新
4. 完成所有问题后是否正确设置完成状态

## 子任务 5.2：实现问答组件

### 复现步骤

1. 创建`src/components/ui/deep-research/QnA.tsx`文件
2. 实现 Vercel AI SDK 集成：
   - 使用`useChat` hook 与 API 通信
   - 处理聊天消息和活动
3. 实现研究流程触发：
   - 监听`isCompleted`状态
   - 在完成问题后发送研究请求
4. 处理研究响应：
   - 提取活动信息
   - 提取来源信息
   - 提取报告内容
   - 更新全局状态

### 测试方法

在浏览器中测试完整的问答流程，验证：

1. 问题回答完成后是否触发研究
2. API 响应是否正确处理
3. 活动和报告是否正确显示

## 子任务 5.3：实现研究活动组件

### 复现步骤

1. 创建`src/components/ui/deep-research/ResearchActivities.tsx`文件
2. 实现可折叠活动面板：
   - 使用 Collapsible 组件
   - 实现标签式界面（活动/来源）
3. 实现活动列表：
   - 显示活动状态（完成/进行中/错误）
   - 显示活动时间戳
   - 格式化活动消息

### 测试方法

在浏览器中运行研究流程，观察研究活动组件，验证：

1. 活动是否实时更新
2. 状态指示器是否正确显示
3. 可折叠面板是否正常工作
4. 标签切换是否正常

## 子任务 5.4：实现已完成问题组件

### 复现步骤

1. 创建`src/components/ui/deep-research/CompletedQuestions.tsx`文件
2. 实现 Accordion 组件：
   - 外层 Accordion 用于整体折叠
   - 内层 Accordion 用于问题折叠
3. 连接到状态管理：
   - 读取问题和答案
   - 只在研究完成后显示

### 测试方法

在浏览器中完成问答流程，验证已完成问题组件是否：

1. 在合适的时机显示
2. 正确显示所有问题和答案
3. 折叠/展开功能是否正常

## 子任务 5.5：实现研究计时器组件

### 复现步骤

1. 创建`src/components/ui/deep-research/ResearchTimer.tsx`文件
2. 实现计时器逻辑：
   - 使用 useEffect 和 useState 实现计时
   - 在研究开始时启动
   - 在研究完成时停止
3. 实现时间格式化

### 测试方法

在浏览器中启动研究流程，验证计时器是否：

1. 在研究开始时启动
2. 实时更新时间
3. 在研究完成时停止
4. 时间格式是否正确

## 子任务 5.6：实现研究报告组件

### 复现步骤

1. 创建`src/components/ui/deep-research/ResearchReport.tsx`文件
2. 实现 Markdown 渲染：
   - 使用 react-markdown 库
   - 配置语法高亮
   - 处理不同内容类型
3. 实现报告下载功能
4. 添加加载状态

### 测试方法

在浏览器中完成整个研究流程，验证报告组件是否：

1. 正确渲染 Markdown 内容
2. 语法高亮是否工作
3. 下载功能是否正常
4. 加载状态是否正确显示
